# jc-matica


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

WEKOで公開されているデータからAIPを作成するツール

## Developer Guide

If you are new to using `nbdev` here are some useful pointers to get you
started.

### Install jc_matica in Development mode

``` sh
# make sure jc_matica package is installed in development mode
$ pip install -e .

# make changes under nbs/ directory
# ...

# compile to have changes apply to jc_matica
$ nbdev_prepare
```

## Usage

### Installation

Install latest from the GitHub
[repository](https://github.com/nakamura196/jc-matica):

``` sh
$ pip install git+https://github.com/nakamura196/jc-matica.git
```

### Documentation

Documentation can be found hosted on this GitHub
[repository](https://github.com/nakamura196/jc-matica)’s
[pages](https://nakamura196.github.io/jc-matica/).

## How to use

Prepare `.env` file:

``` txt
# Archivematicaの設定
DASHBOARD_URL=http://localhost:62080
DASHBOARD_USERNAME=test
DASHBOARD_API_KEY=test

STORAGE_SERVICE_URL=http://localhost:62081
STORAGE_SERVICE_USERNAME=test
STORAGE_SERVICE_PASSWORD=test

LOCATION_UUID=624454a4-1555-4a0f-ba6b-969452966cd4
PROCESSING_CONFIG=mdx

# オブジェクトストレージの設定
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

OS_ENDPOINT=https://s3ds.mdx.jp
OS_BUCKET_NAME=
OS_AIP_PREFIX=aip_storage
OS_TRANSFER_PREFIX=transfer_source/jc
```

Pip install:

``` bash
pip install https://github.com/nakamura196/archivematica_tools.git
```

Create AIP with Archivematica:

``` python
from jc_matica.core import ApiClient
from archivematica_tools.api import ArchivematicaAPIClient
from archivematica_tools.vis import VisClient
from dotenv import load_dotenv
import os

load_dotenv(override=True)

# https://kanazawa-u.repo.nii.ac.jp/records/26572
prefix = "kanazawa-u"
id = "26572"
output_dir = f"./data"
transfer_type = "standard"
transfer_accession = ""
location_uuid = os.getenv("LOCATION_UUID")
processing_config = os.getenv("PROCESSING_CONFIG")

## Upload Dataset to S3 compatible storage
client = ApiClient()
client.upload(prefix, id, output_dir)

## Create AIP with Archivematica
path = f"jc/{prefix}_{id}"
name = f"{prefix}_{id}"

sip_uuid = ArchivematicaAPIClient.main(transfer_type, transfer_accession, location_uuid, path, name, processing_config, env_path=env_path)

## Visualize AIP
res = VisClient.main(sip_uuid)
res.get_original_files()
res.visualize_file_format_counts()
res.visualize_file_events_count()
res.parse_file_sec()
res.visualize_structMap()
```
